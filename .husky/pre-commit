#!/bin/sh
# Unix/Linux/Mac의 경우
# chmod +x .husky/pre-commit

# Windows의 경우 (Git Bash 사용)
# git update-index --chmod=+x .husky/pre-commit

echo "Husky is Running!"

# Get current branch name
BRANCH_NAME=$(git rev-parse --abbrev-ref HEAD)

# Check branch name format
if ! echo "$BRANCH_NAME" | grep -qE '^(feature|bugfix)/KAN-[0-9]+-[a-zA-Z0-9-]+$'; then
    echo "Error: Branch name must follow the format 'feature/KAN-{number}-{content}' or 'bugfix/KAN-{number}-{content}'"
    echo "Current branch name: $BRANCH_NAME"
    exit 1
fi

echo "Branch name validation passed!"

echo "Commit message validation passed!"
echo "Code format and ESLint"
npm run lint
npm run format
echo "End of Code format and ESLint"